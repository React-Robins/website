{"version":3,"file":"serialize.cjs.js","sources":["../src/index.js"],"sourcesContent":["// @flow\nimport type {\n  Interpolation,\n  ScopedInsertableStyles,\n  RegisteredCache\n} from '@emotion/utils'\nimport hashString from '@emotion/hash'\nimport unitless from '@emotion/unitless'\nimport memoize from '@emotion/memoize'\n\nconst hyphenateRegex = /[A-Z]|^ms/g\n\nexport const processStyleName: (styleName: string) => string = memoize(\n  (styleName: string) => styleName.replace(hyphenateRegex, '-$&').toLowerCase()\n)\n\nexport let processStyleValue = (key: string, value: string): string => {\n  if (value == null || typeof value === 'boolean') {\n    return ''\n  }\n\n  if (\n    unitless[key] !== 1 &&\n    key.charCodeAt(1) !== 45 && // custom properties\n    !isNaN(value) &&\n    value !== 0\n  ) {\n    return value + 'px'\n  }\n  return value\n}\n\nif (process.env.NODE_ENV !== 'production') {\n  let contentValuePattern = /(attr|calc|counters?|url)\\(/\n  let contentValues = [\n    'normal',\n    'none',\n    'counter',\n    'open-quote',\n    'close-quote',\n    'no-open-quote',\n    'no-close-quote',\n    'initial',\n    'inherit',\n    'unset'\n  ]\n  let oldProcessStyleValue = processStyleValue\n  processStyleValue = (key: string, value: string) => {\n    if (key === 'content') {\n      if (\n        typeof value !== 'string' ||\n        (contentValues.indexOf(value) === -1 &&\n          !contentValuePattern.test(value) &&\n          (value.charAt(0) !== value.charAt(value.length - 1) ||\n            (value.charAt(0) !== '\"' && value.charAt(0) !== \"'\")))\n      ) {\n        console.error(\n          `You seem to be using a value for 'content' without quotes, try replacing it with \\`content: '\"${value}\"'\\``\n        )\n      }\n    }\n    return oldProcessStyleValue(key, value)\n  }\n}\n\nexport function handleInterpolation(\n  registered: RegisteredCache,\n  interpolation: Interpolation\n): string | number {\n  if (interpolation == null) {\n    return ''\n  }\n  if (interpolation.__emotion_styles !== undefined) {\n    if (\n      interpolation.toString() === 'NO_COMPONENT_SELECTOR' &&\n      process.env.NODE_ENV !== 'production'\n    ) {\n      throw new Error(\n        'Component selectors can only be used in conjunction with babel-plugin-emotion.'\n      )\n    }\n    return interpolation\n  }\n\n  switch (typeof interpolation) {\n    case 'boolean': {\n      return ''\n    }\n    case 'object': {\n      if (interpolation.type === 2) {\n        return interpolation.name\n      }\n      if (interpolation.styles !== undefined) {\n        return interpolation.styles\n      }\n\n      return createStringFromObject.call(this, registered, interpolation)\n    }\n    case 'function': {\n      if (this !== undefined) {\n        return handleInterpolation.call(\n          this,\n          registered,\n          // $FlowFixMe\n          interpolation(this)\n        )\n      }\n    }\n    // eslint-disable-next-line no-fallthrough\n    default: {\n      const cached = registered[interpolation]\n      return cached !== undefined ? cached : interpolation\n    }\n  }\n}\n\nfunction createStringFromObject(\n  registered: RegisteredCache,\n  obj: { [key: string]: Interpolation }\n): string {\n  let string = ''\n\n  if (Array.isArray(obj)) {\n    obj.forEach(function(interpolation: Interpolation) {\n      string += handleInterpolation.call(this, registered, interpolation)\n    }, this)\n  } else {\n    Object.keys(obj).forEach(function(key: string) {\n      if (typeof obj[key] !== 'object') {\n        string += `${processStyleName(key)}:${processStyleValue(\n          key,\n          obj[key]\n        )};`\n      } else {\n        if (\n          key === 'NO_COMPONENT_SELECTOR' &&\n          process.env.NODE_ENV !== 'production'\n        ) {\n          throw new Error(\n            'Component selectors can only be used in conjunction with @emotion/babel-plugin-core.'\n          )\n        }\n        if (\n          Array.isArray(obj[key]) &&\n          (typeof obj[key][0] === 'string' &&\n            registered[obj[key][0]] === undefined)\n        ) {\n          obj[key].forEach(value => {\n            string += `${processStyleName(key)}:${processStyleValue(\n              key,\n              value\n            )};`\n          })\n        } else {\n          string += `${key}{${handleInterpolation.call(\n            this,\n            registered,\n            obj[key]\n          )}}`\n        }\n      }\n    }, this)\n  }\n\n  return string\n}\n\nexport const labelPattern = /label:\\s*([^\\s;\\n{]+)\\s*;/g\n\nexport const serializeStyles = function(\n  registered: RegisteredCache,\n  args: Array<Interpolation>\n): ScopedInsertableStyles {\n  if (\n    args.length === 1 &&\n    typeof args[0] === 'object' &&\n    args[0] !== null &&\n    args[0].styles !== undefined\n  ) {\n    return args[0]\n  }\n  let styles = ''\n  let identifierName = ''\n  args.forEach(function(interpolation, i) {\n    styles += handleInterpolation.call(this, registered, interpolation)\n  }, this)\n  styles = styles.replace(labelPattern, (match, p1: string) => {\n    identifierName += `-${p1}`\n    return ''\n  })\n  let name = hashString(styles) + identifierName\n\n  return {\n    name,\n    styles\n  }\n}\n"],"names":["hyphenateRegex","processStyleName","memoize","styleName","replace","toLowerCase","processStyleValue","key","value","unitless","charCodeAt","isNaN","process","env","NODE_ENV","contentValuePattern","contentValues","oldProcessStyleValue","indexOf","test","charAt","length","error","handleInterpolation","registered","interpolation","__emotion_styles","undefined","toString","Error","type","name","styles","createStringFromObject","call","cached","obj","string","Array","isArray","forEach","keys","labelPattern","serializeStyles","args","identifierName","i","match","p1","hashString"],"mappings":"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"}